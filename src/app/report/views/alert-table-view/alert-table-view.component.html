<div *ngIf="alerts">
  <p-table
    [value]="alerts"
    [(selection)]="selectedAlerts"
    [paginator]="true"
    [rows]="10"
    [showCurrentPageReport]="true"
    currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
    [rowsPerPageOptions]="[10, 25, 50]"
    [globalFilterFields]="['severity']"
    dataKey="id"
  >
    <ng-template pTemplate="header">
      <tr>
        <th style="width: 3rem">
          <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
        </th>
        <th pSortableColumn="createdAt">
          Date <p-sortIcon field="createdAt"></p-sortIcon>
        </th>
        <th pSortableColumn="message">
          Alert <p-sortIcon field="message"></p-sortIcon>
        </th>
        <th pSortableColumn="severity">
          Severity <p-sortIcon field="severity"></p-sortIcon>
        </th>
        <th pSortableColumn="type">
          Type <p-sortIcon field="type"></p-sortIcon>
        </th>
        <th pSortableColumn="buildingId">
          Building <p-sortIcon field="buildingId"></p-sortIcon>
        </th>
      </tr>
      <tr>
        <th style="width: 3rem">
          <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
        </th>
        <th></th>
        <th>
          <p-columnFilter
            type="text"
            field="message"
            display="menu"
          ></p-columnFilter>
        </th>
        <th>
          <p-columnFilter field="severity" matchMode="in" [showMenu]="false">
            <ng-template
              pTemplate="filter"
              let-value
              let-filter="filterCallback"
            >
              <p-multiSelect
                [ngModel]="value"
                [options]="severities"
                placeholder="Any"
                optionLabel="label"
                optionValue="value"
                (onChange)="filter($event.value)"
                [showHeader]="false"
              >
                <ng-template let-option pTemplate="item">
                  <div class="p-multiselect-representative-option">
                    <p-tag
                      [value]="
                        AlertSeverityName[option.value] | underscoreToSpace
                      "
                      [rounded]="true"
                      severity="info"
                      styleClass="severity-{{ option.value }}"
                    ></p-tag>
                  </div>
                </ng-template>
              </p-multiSelect>
            </ng-template>
          </p-columnFilter>
        </th>
        <th>
          <p-columnFilter field="type" matchMode="in" [showMenu]="false">
            <ng-template
              pTemplate="filter"
              let-value
              let-filter="filterCallback"
            >
              <p-multiSelect
                [ngModel]="value"
                [options]="alertTypes"
                placeholder="Any"
                optionLabel="label"
                optionValue="value"
                (onChange)="filter($event.value)"
                [showHeader]="false"
              >
                <ng-template let-option pTemplate="item">
                  <div class="p-multiselect-representative-option">
                    {{ option.label }}
                  </div>
                </ng-template>
              </p-multiSelect>
            </ng-template>
          </p-columnFilter>
        </th>
        <th></th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-alert>
      <tr>
        <td>
          <p-tableCheckbox [value]="alert"></p-tableCheckbox>
        </td>
        <td>{{ alert.createdAt | date }}</td>
        <td>
          {{ alert.message }}
        </td>
        <td class="{{ alert.severity | colorByAlertSeverity }}">
          <p-tag
            [value]="AlertSeverityName[alert.severity] | underscoreToSpace"
            [rounded]="true"
            severity="info"
            styleClass="severity-{{ alert.severity }}"
          ></p-tag>
        </td>
        <td>
          {{ AlertTypeName[alert.type] | underscoreToSpace }}
        </td>
        <td>{{ alert.buildingId }}</td>
      </tr>
    </ng-template>
  </p-table>
</div>
