<div class="overview-panel has-shadow" [class.expanded]="expanded === true">
  <div class="zoom-controls">
    <app-zoom-controls></app-zoom-controls>
  </div>
  <div class="p-d-flex p-flex-column overflow-hidden">
    <div class="p-d-flex p-flex-column">
      <a class="menu-toggle p-d-flex p-align-center" (click)="toggleSize()">
        <i
          class="fas fa-border"
          [class.fa-arrow-to-left]="expanded === false"
          [class.fa-arrow-to-right]="expanded === true"
        ></i>
      </a>
      <ng-container *ngIf="expanded">
        <div #topPanel>
          <div class="p-d-flex p-align-top p-mt-4">
            <div class="p-flex-column p-mr-2">
              <i class="fas fa-graduation-cap fa-fw color-grey"></i>
            </div>
            <div class="p-flex-column flex-grow-1">
              <h3 class="p-m-0">{{ selectedLocation?.name }}</h3>
              <div class="p-d-flex p-jc-between color-text-medium">
                <div class="p-flex-column">
                  <small>{{ mapDateTime | date: "longDate" }}</small>
                  &nbsp;<small>{{ mapDateTime | date: "shortTime" }}</small>
                  <small *ngIf="isPlaybackLive" class="color-red">
                    &nbsp; <strong>LIVE</strong></small
                  >
                </div>
              </div>
            </div>
          </div>
          <div class="p-mt-3">
            <p-accordion
              (onOpen)="onAccordionToggle($event)"
              (onClose)="onAccordionToggle($event)"
              expandIcon=""
            >
              <p-accordionTab transitionOptions="0ms">
                <ng-template pTemplate="header">
                  <div class="p-flex-column flex-grow-1">
                    <i class="icon fas fa-play-circle fa-fw p-mr-2"></i>
                    Playback
                  </div>
                  <div class="p-flex-column">
                    <p-calendar
                      [(ngModel)]="playbackDate"
                      [showIcon]="true"
                      icon="fas fa-clock"
                      inputId="icon"
                      appendTo="body"
                      class="only-icon"
                      (click)="stopPropagation($event)"
                      (onSelect)="onPlaybackCalendarSelect($event)"
                      panelStyleClass="small"
                      [showTime]="true"
                      hourFormat="12"
                    ></p-calendar>
                  </div>
                </ng-template>
                <ng-template pTemplate="content">
                  <div class="p-d-flex p-ai-center">
                    <div class="p-flex-column flex-grow-1 p-as-stretch">
                      <button
                        pButton
                        pRipple
                        type="button"
                        [icon]="isPlaybackLive ? 'fas fa-pause' : 'fas fa-play'"
                        class="btn-playback p-button-outlined height-100"
                        [ngClass]="{ 'is-active': isPlaybackLive === true }"
                        (click)="onTogglePlayback()"
                      ></button>
                    </div>
                    <div class="p-flex-column p-text-right">
                      <button
                        pButton
                        pRipple
                        type="button"
                        label="1d"
                        icon="fas fa-chevron-double-left"
                        class="
                          p-button-secondary
                          p-button-sm
                          p-button-xs
                          p-button-outlined
                          p-mr-1
                          p-mb-1
                        "
                        (click)="onPlaybackIntervalChange(-1, 'day')"
                      ></button>
                      <button
                        pButton
                        pRipple
                        type="button"
                        label="1hr"
                        icon="fas fa-chevron-left"
                        class="
                          p-button-secondary
                          p-button-sm
                          p-button-xs
                          p-button-outlined
                          p-mr-1
                          p-mb-1
                        "
                        (click)="onPlaybackIntervalChange(-1, 'hour')"
                      ></button>
                      <button
                        pButton
                        pRipple
                        type="button"
                        label="1m"
                        icon="fas fa-chevron-left"
                        class="
                          p-button-secondary
                          p-button-sm
                          p-button-xs
                          p-button-outlined
                          p-mb-1
                        "
                        (click)="onPlaybackIntervalChange(-1, 'minute')"
                      ></button>
                      <button
                        pButton
                        pRipple
                        type="button"
                        label="1d"
                        icon="fas fa-chevron-double-right"
                        class="
                          p-button-secondary
                          p-button-sm
                          p-button-xs
                          p-button-outlined
                          p-mr-1
                        "
                        (click)="onPlaybackIntervalChange(1, 'day')"
                        [disabled]="isPlaybackLive || isDateInFuture(1, 'day')"
                      ></button>
                      <button
                        pButton
                        pRipple
                        type="button"
                        label="1hr"
                        icon="fas fa-chevron-right"
                        class="
                          p-button-secondary
                          p-button-sm
                          p-button-xs
                          p-button-outlined
                          p-mr-1
                        "
                        (click)="onPlaybackIntervalChange(1, 'hour')"
                        [disabled]="isPlaybackLive || isDateInFuture(1, 'hour')"
                      ></button>
                      <button
                        pButton
                        pRipple
                        type="button"
                        label="1m"
                        icon="fas fa-chevron-right"
                        class="
                          p-button-secondary
                          p-button-sm
                          p-button-xs
                          p-button-outlined
                        "
                        (click)="onPlaybackIntervalChange(1, 'minute')"
                        [disabled]="
                          isPlaybackLive || isDateInFuture(1, 'minute')
                        "
                      ></button>
                    </div>
                  </div>
                </ng-template>
              </p-accordionTab>
              <p-accordionTab transitionOptions="0ms">
                <ng-template pTemplate="header">
                  <i class="icon fas fa-eye fa-fw p-mr-2"></i> Map View
                </ng-template>
                <ng-template pTemplate="content">
                  <!-- <div class="p-d-flex p-align-center">
                    <div class="p-flex-column flex-grow-1">
                      <label for="footTraffic">
                        <i class="fas fa-check p-mr-2"></i>
                        <small class="color-text-medium">Foot Traffic</small>
                      </label>
                    </div>
                    <div class="p-flex-column">
                      <small>
                        <p-inputSwitch
                          inputId="footTraffic"
                          [(ngModel)]="footTraffic"
                        ></p-inputSwitch
                      ></small>
                    </div>
                  </div> -->
                  <div class="p-d-flex p-align-center p-mt-2">
                    <div class="p-flex-column flex-grow-1">
                      <label for="staticDevices">
                        <!-- <i class="fas fa-check p-mr-2 color-primary"></i> -->
                        <div class="icoDevice"></div>
                        <small class="color-text-medium">Devices</small>
                      </label>
                    </div>
                    <div class="p-flex-column">
                      <small>
                        <p-inputSwitch
                          inputId="staticDevices"
                          [(ngModel)]="staticDevices"
                          (onChange)="onToggleDevices($event)"
                        ></p-inputSwitch
                      ></small>
                    </div>
                  </div>
                  <div class="p-d-flex p-align-center p-mt-2">
                    <div class="p-flex-column flex-grow-1">
                      <label for="accessPoints">
                        <!-- <i class="fas fa-check p-mr-2"></i> -->
                        <img
                          src="./assets/img/access-point.png"
                          class="icoAccessPoint"
                        />
                        <small class="color-text-medium">Access Points</small>
                      </label>
                    </div>
                    <div class="p-flex-column">
                      <small>
                        <p-inputSwitch
                          inputId="accessPoints"
                          [(ngModel)]="accessPoints"
                          (onChange)="onToggleAccessPoints($event)"
                        ></p-inputSwitch
                      ></small>
                    </div>
                  </div>
                  <!-- <h5 class="p-mb-2">Data Density</h5>
                  <div class="p-d-flex p-jc-between">
                    <div>
                      <small class="color-text-medium display-block p-mb-2">
                        Foot Traffic
                      </small>
                      <div>
                        <i class="fas fa-check fa-fw p-mr-2"></i>
                        <small class="color-text-medium">1 - 5</small>
                      </div>
                      <div>
                        <i class="fas fa-check fa-fw p-mr-2"></i>
                        <small class="color-text-medium">25 - 50</small>
                      </div>
                      <div>
                        <i class="fas fa-check fa-fw p-mr-2"></i>
                        <small class="color-text-medium">50+</small>
                      </div>
                    </div>
                    <div>
                      <small class="color-text-medium display-block p-mb-2">
                        Static Devices
                      </small>
                      <div>
                        <i class="fas fa-check fa-fw p-mr-2"></i>
                        <small class="color-text-medium">1 - 5</small>
                      </div>
                      <div>
                        <i class="fas fa-check fa-fw p-mr-2"></i>
                        <small class="color-text-medium">5+</small>
                      </div>
                    </div>
                  </div> -->
                </ng-template>
              </p-accordionTab>
              <p-accordionTab transitionOptions="0ms">
                <ng-template pTemplate="header">
                  <div class="p-d-flex p-align-center p-jc-between flex-grow-1">
                    <div class="p-flex-column flex-grow-1">
                      <i
                        class="icon fas fa-exclamation-triangle fa-fw p-mr-2"
                      ></i>
                      Alerts
                    </div>
                    <div class="p-flex-column">
                      <small>
                        <p-dropdown
                          [options]="alertSortOptions"
                          (click)="stopPropagation($event)"
                          (onChange)="onSortChange($event)"
                          [(ngModel)]="selectedAlertSortOption"
                          placeholder="Sort By"
                          optionLabel="name"
                          optionValue="value"
                          value="2"
                          dropdownIcon="fas fa-chevron-down"
                        ></p-dropdown>
                      </small>
                    </div>
                  </div>
                </ng-template>
                <ng-template pTemplate="content">
                  <div class="p-d-flex p-jc-between">
                    <div class="flex-grow-1">
                      <div>
                        <small>
                          <p-checkbox
                            name="severeUrgency"
                            [(ngModel)]="severeUrgency"
                            (onChange)="onToggleSevereUrgency($event)"
                            [binary]="true"
                            checkboxIcon="fas fa-check"
                            label="Severe severity"
                          ></p-checkbox>
                        </small>
                      </div>
                      <div class="p-mt-2">
                        <small>
                          <p-checkbox
                            name="highUrgency"
                            [(ngModel)]="highUrgency"
                            (onChange)="onToggleHighUrgency($event)"
                            [binary]="true"
                            checkboxIcon="fas fa-check"
                            label="High severity"
                          ></p-checkbox>
                        </small>
                      </div>
                      <div class="p-mt-2">
                        <small>
                          <p-checkbox
                            name="acknowledged"
                            [(ngModel)]="acknowledged"
                            (onChange)="onToggleAcknowledged($event)"
                            [binary]="true"
                            checkboxIcon="fas fa-check"
                            label="Acknowledged"
                          ></p-checkbox>
                        </small>
                      </div>
                    </div>
                    <div class="flex-grow-1">
                      <div>
                        <small>
                          <p-checkbox
                            name="medUrgency"
                            [(ngModel)]="medUrgency"
                            (onChange)="onToggleMediumUrgency($event)"
                            [binary]="true"
                            checkboxIcon="fas fa-check"
                            label="Med. severity"
                          ></p-checkbox>
                        </small>
                      </div>
                      <div class="p-mt-2">
                        <small>
                          <p-checkbox
                            name="lowUrgency"
                            [(ngModel)]="lowUrgency"
                            (onChange)="onToggleLowUrgency($event)"
                            [binary]="true"
                            checkboxIcon="fas fa-check"
                            label="Low severity"
                          ></p-checkbox>
                        </small>
                      </div>
                    </div>
                  </div>
                </ng-template>
              </p-accordionTab>
            </p-accordion>
          </div>
        </div>
        <app-alert-panel
          #alertPanel
          class="alert-panel-container"
        ></app-alert-panel>
      </ng-container>
    </div>
  </div>
</div>
